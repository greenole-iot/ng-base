!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/common/http"),require("rxjs/webSocket"),require("lodash-es"),require("auth0-js")):"function"==typeof define&&define.amd?define("@alis/ng-base",["exports","@angular/core","rxjs","rxjs/operators","@angular/common/http","rxjs/webSocket","lodash-es","auth0-js"],e):e(((t=t||self).alis=t.alis||{},t.alis["ng-base"]={}),t.ng.core,t.rxjs,t.rxjs.operators,t.ng.common.http,t.rxjs.webSocket,t._,t.auth0)}(this,(function(t,e,r,n,o,i,c,s){"use strict";var u=function(){},p=function(){},a=function(){function t(e,r){this.propertiesUrl=e,this.http=r,null==this.propertiesUrl?(this.propertiesUrl=t.DEFAULT_APP_CONFIG_PATH,console.info("Did not receive propertiesUrl path. Using default as '"+this.propertiesUrl+"'")):console.info("Received propertiesUrl path as '"+this.propertiesUrl+"'")}return t.prototype.setPropertiesUrl=function(t){this.propertiesUrl=t,console.info("PropertiesUrl has been set to: "+t)},t.prototype.readProperties=function(t){return this.http.get(t).pipe(n.catchError((function(e){return console.error("ERROR: Properties file "+t+" not found."),r.throwError(e)})))},t.prototype.getAppConfig=function(){return this.readProperties(this.propertiesUrl)},t.prototype.readAllProperties=function(){return this.readProperties(this.propertiesUrl).pipe(n.map((function(e){t.properties=e})))},t}();a.DEFAULT_APP_CONFIG_PATH="assets/appConfig.properties.json",a.properties=null,a.ɵfac=function(t){return new(t||a)(e.ɵɵinject("propertiesUrl",8),e.ɵɵinject(o.HttpClient))},a.ɵprov=e.ɵɵdefineInjectable({token:a,factory:a.ɵfac,providedIn:"root"});var f=function(){function t(t){this.http=t}return t.prototype.list=function(t,e){var r=a.properties.aurionTrack+"/state/"+t+"/"+e;return this.http.get(r)},t.prototype.get=function(t,e,r){var n=a.properties.aurionTrack+"/state/"+t+"/"+e+"/"+r;return this.http.get(n)},t.prototype.searchExecutionsByProcess=function(t,e,r){var n=a.properties.aurionTrack+"/state/"+t+"/"+e+"?search=processId.eq:"+r+"&sort=timestamp:asc";return this.http.get(n)},t}();f.ɵfac=function(t){return new(t||f)(e.ɵɵinject(o.HttpClient))},f.ɵprov=e.ɵɵdefineInjectable({token:f,factory:f.ɵfac,providedIn:"root"});var h=function(){function t(t){this.http=t}return t.prototype.get=function(){var t=this;if(a.properties.structuresmock)return this.structuresMockCache?r.of(this.structuresMockCache):this.http.get(a.properties.structuresmock).pipe(n.tap((function(e){t.structuresMockCache=e})))},t.prototype.set=function(t){if(a.properties.structuresmock){this.structuresMockCache||(this.structuresMockCache=[]);var e=this.structuresMockCache.findIndex((function(e){return e.id==t.id}));return-1!=e?this.structuresMockCache.splice(e,0,t):this.structuresMockCache.push(t),r.of(1)}},t}();h.ɵfac=function(t){return new(t||h)(e.ɵɵinject(o.HttpClient))},h.ɵprov=e.ɵɵdefineInjectable({token:h,factory:h.ɵfac,providedIn:"root"});var l=function(){function t(){}return t.prototype.connect=function(t){var e=a.properties.trackingwebsocket;return this.myWebSocket=i.webSocket(e),null!=t&&this.myWebSocket.next(t),this.myWebSocket},t.prototype.disconnect=function(){this.myWebSocket&&this.myWebSocket.complete()},t}();l.ɵfac=function(t){return new(t||l)},l.ɵprov=e.ɵɵdefineInjectable({token:l,factory:l.ɵfac,providedIn:"root"});var d=function(){function t(){}return t.prototype.connect=function(t){var e=a.properties.eventwebsocket;return this.myWebSocket=i.webSocket(e),null!=t&&this.myWebSocket.next(t),this.myWebSocket},t.prototype.disconnect=function(){this.myWebSocket.complete()},t}();d.ɵfac=function(t){return new(t||d)},d.ɵprov=e.ɵɵdefineInjectable({token:d,factory:d.ɵfac,providedIn:"root"});var v=function(){function t(t){this.http=t}return t.prototype.get=function(t,e,r,n){var o=a.properties.aurionTrack;return this.http.get(o+"/trace/"+t+"/"+r+"/"+e+"?startTimestamp="+n)},t.prototype.getByType=function(t,e){var r=a.properties.aurionTrack;return this.http.get(r+"/state/"+t+"/"+e)},t.prototype.getLatestByDomainsAndTag=function(t,e){if(a.properties.trackingsmock)return this.http.get(a.properties.trackingsmock).pipe(n.map((function(r){r=r.filter((function(e){return-1!=t.indexOf(e.domainId)})).filter((function(t){var r;return null===(r=t.tags)||void 0===r?void 0:r.find((function(t){return t==e}))}));var n=c.groupBy(r,(function(t){return t.objectId}));return Object.keys(n).map((function(t){return n[t]})).map((function(t){return t.sort((function(t,e){return e.timestamp-t.timestamp}))[0]}))})))},t.prototype.set=function(t){var e=a.properties.aurionTrack;return this.http.post(e+"/trace",t)},t}();v.ɵfac=function(t){return new(t||v)(e.ɵɵinject(o.HttpClient))},v.ɵprov=e.ɵɵdefineInjectable({token:v,factory:v.ɵfac,providedIn:"root"});var y=function(){function t(t){this.http=t}return t.prototype.getEventsBySubject=function(t,e,r,n){var o=a.properties.aurionEvent+"/event/subject/"+t+"/"+e+"?startTimestamp="+r;return null!=n&&(o+="&search="+n),this.http.get(o)},t.prototype.getEvents=function(t,e,r){var n=a.properties.aurionEvent+"/event/object/"+t+"/"+e+"?startTimestamp="+r;return this.http.get(n)},t}();y.ɵfac=function(t){return new(t||y)(e.ɵɵinject(o.HttpClient))},y.ɵprov=e.ɵɵdefineInjectable({token:y,factory:y.ɵfac,providedIn:"root"});function b(t,e,r,n){return new(r||(r=Promise))((function(o,i){function c(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(c,s)}u((n=n.apply(t,e||[])).next())}))}function g(t,e){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}Object.create;Object.create;var m=function(){function t(){}return Object.defineProperty(t.prototype,"webAuth",{get:function(){return null==this.innerwebAuth&&(this.innerwebAuth=new s.WebAuth({clientID:a.properties.auth0.clientId,domain:a.properties.auth0.domain,scope:"openid profile email current_user",responseType:"token id_token code",redirectUri:a.properties.auth0.redirectUri+(this.extraRedirectUri?this.extraRedirectUri:"")})),this.innerwebAuth},enumerable:!1,configurable:!0}),t.prototype.authenticate=function(t,e,n){var o=this;this.extraRedirectUri=n;var i=new r.BehaviorSubject(!1);return this.webAuth.login({realm:a.properties.auth0.realm,username:t,password:e},(function(t,e){null!=t&&(console.error("Usuário e/ou senha errados."),r.throwError("Usuário e/ou senha errados.")),o.user=e,console.log(e),i.next(!0)})),i},t.prototype.forgotPassword=function(t){var e=new r.BehaviorSubject(!1);return this.webAuth.changePassword({connection:a.properties.auth0.realm,email:t},(function(t,n){t&&(console.error(t),r.throwError(JSON.stringify(t))),e.next(!0)})),e},t.prototype.handleAuthentication=function(){return b(this,void 0,void 0,(function(){var t=this;return g(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e,r){t.webAuth.parseHash((function(t,n){console.log(n),t?(console.error(t),r(t)):e(n)}))})).then((function(e){console.log(e),e&&e.accessToken&&e.idToken&&t.setUser(e)})).catch((function(t){console.error(t)}))];case 1:return e.sent(),[2]}}))}))},t.prototype.setUser=function(t){this.user=t,sessionStorage.setItem("user",JSON.stringify(t))},t.prototype.getUser=function(){var t=sessionStorage.getItem("user");return null!=t&&""!=t&&(this.user=JSON.parse(t)),this.user},t.prototype.isUserLoggedIn=function(){return null!=this.getUser()},t.prototype.logout=function(){this.user=null,sessionStorage.removeItem("user")},t}();m.ɵfac=function(t){return new(t||m)},m.ɵprov=e.ɵɵdefineInjectable({token:m,factory:m.ɵfac,providedIn:"root"});var k=function(){};k.ɵmod=e.ɵɵdefineNgModule({type:k}),k.ɵinj=e.ɵɵdefineInjector({factory:function(t){return new(t||k)},imports:[[o.HttpClientModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&e.ɵɵsetNgModuleScope(k,{imports:[o.HttpClientModule]}),t.Auth0AuthService=m,t.Event=p,t.EventService=y,t.EventWebsocketService=d,t.NgBaseLibModule=k,t.PropertiesService=a,t.StateService=f,t.StructureService=h,t.Trace=u,t.TrackingService=v,t.TrackingWebsocketService=l,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=alis-ng-base.umd.min.js.map